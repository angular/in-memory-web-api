{"version":3,"sources":["http-backend.service.ts"],"names":[],"mappings":"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","file":"http-backend.service.js","sourceRoot":"","sourcesContent":["import { Inject, Injectable, Injector, Optional } from '@angular/core';\n\nimport { BrowserXhr, Connection, ConnectionBackend,\n         Headers, ReadyState, Request, RequestMethod,\n         Response,\n         ResponseOptions as HttpResponseOptions,\n         ResponseOptionsArgs,\n         URLSearchParams,\n         XHRBackend, XSRFStrategy } from '@angular/http';\n\nimport { Observable } from 'rxjs/Observable';\nimport { map } from 'rxjs/operator/map';\n\nimport { STATUS } from './http-status-codes';\n\nimport {\n  InMemoryBackendConfig,\n  InMemoryBackendConfigArgs,\n  InMemoryDbService,\n  ResponseOptions\n} from './interfaces';\n\nimport { BackendService } from './backend.service';\n\n/**\n * For Angular `Http` simulate the behavior of a RESTy web api\n * backed by the simple in-memory data store provided by the injected `InMemoryDbService`.\n * Conforms mostly to behavior described here:\n * http://www.restapitutorial.com/lessons/httpmethods.html\n *\n * ### Usage\n *\n * Create an in-memory data store class that implements `InMemoryDbService`.\n * Call `forRoot` static method with this service class and optional configuration object:\n * ```\n * // other imports\n * import { HttpModule } from '@angular/http';\n * import { HttpClientInMemoryWebApiModule } from 'angular-in-memory-web-api';\n *\n * import { InMemHeroService, inMemConfig } from '../api/in-memory-hero.service';\n * @NgModule({\n *  imports: [\n *    HttpModule,\n *    HttpClientInMemoryWebApiModule.forRoot(InMemHeroService, inMemConfig),\n *    ...\n *  ],\n *  ...\n * })\n * export class AppModule { ... }\n * ```\n */\n\nexport class HttpBackendService extends BackendService implements ConnectionBackend {\n\n  constructor(\n    private injector: Injector,\n    inMemDbService: InMemoryDbService,\n      config: InMemoryBackendConfigArgs\n    ) {\n    super(inMemDbService, config);\n  }\n\n  createConnection(req: Request): Connection {\n    let response: Observable<Response>;\n    try {\n      response = this.handleRequest(req);\n\n    } catch (error) {\n      const err = error.message || error;\n      const resOptions = this.createErrorResponseOptions(req.url, STATUS.INTERNAL_SERVER_ERROR, `${err}`);\n      response = this.createResponse$(() => resOptions);\n    }\n\n    return {\n      readyState: ReadyState.Done,\n      request: req,\n      response\n    };\n  }\n\n  ////  protected overrides /////\n\n  protected getJsonBody(req: Request): any {\n    try {\n      return req.json();\n    } catch (e) {\n      const msg = `'${req.url}' request body-to-json error\\n${JSON.stringify(e)}`;\n      throw new Error(msg);\n    }\n  }\n\n  protected getRequestMethod(req: Request): string {\n    return RequestMethod[req.method || 0].toLowerCase();\n  }\n\n  protected createHeaders(headers: { [index: string]: string; }): Headers {\n    return new Headers(headers);\n  }\n\n  protected createQueryMap(search: string): Map<string, string[]> {\n    return search ? new URLSearchParams(search).paramsMap : new Map<string, string[]>();\n  }\n\n  protected createResponse$fromResponseOptions$(resOptions$: Observable<ResponseOptions>): Observable<Response> {\n    return map.call(resOptions$, (opts: ResponseOptionsArgs) => {\n      return new Response(new HttpResponseOptions(opts));\n    });\n  }\n\n  protected createPassThruBackend() {\n    try {\n      // copied from @angular/http/backends/xhr_backend\n      const browserXhr = this.injector.get(BrowserXhr);\n      const baseResponseOptions = this.injector.get(HttpResponseOptions);\n      const xsrfStrategy = this.injector.get(XSRFStrategy);\n      const xhrBackend = new XHRBackend(browserXhr, baseResponseOptions, xsrfStrategy);\n\n      return {\n        handle: (req: Request) => xhrBackend.createConnection(req).response\n      };\n\n    } catch (e) {\n      e.message = 'Cannot create passThru404 backend; ' + (e.message || '');\n      throw e;\n    }\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Injector, },\n{type: InMemoryDbService, },\n{type: InMemoryBackendConfigArgs, decorators: [{ type: Inject, args: [InMemoryBackendConfig, ] }, { type: Optional }, ]},\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}